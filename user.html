<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Min sida – TerraTrade</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    :root{--bg:#0e1a11;--bg2:#122218;--line:#24432f;--text:#edf5ee;--muted:#b6c7b8;--card:#16271e;--leaf:#50c878;--leaf2:#3ebd94}
    *{box-sizing:border-box} body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;color:var(--text);background:
      radial-gradient(1000px 700px at 80% -10%, rgba(47,191,113,.15), transparent 60%),linear-gradient(180deg,var(--bg),var(--bg2));min-height:100svh}
    .container{max-width:800px;margin:0 auto;padding:18px}
    .panel{border:1px solid var(--line);background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.01)) var(--card);border-radius:16px;padding:16px;margin-top:20px}
    button{background:var(--leaf);border:none;color:#082013;padding:10px 14px;border-radius:10px;font-weight:800;cursor:pointer}
    button:hover{background:var(--leaf2)} .muted{color:var(--muted)}
  </style>
</head>
<body>
  <div class="container">
    <div class="panel">
      <h1>Välkommen</h1>
      <p class="muted" id="info">Laddar...</p>
      <div style="display:flex;gap:10px;margin-top:10px">
        <a href="login.html"><button id="logoutBtn">Logga ut</button></a>
      </div>
    </div>
  </div>
<script>
const supabase=window.supabase.createClient(
  "https://vkapxmpecvmrquockugi.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZrYXB4bXBlY3ZtcnF1b2NrdWdpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExMjU3MjYsImV4cCI6MjA3NjcwMTcyNn0.VYTNc3gGQLe5KJIP2952I549h9n1SZiycSYQ9MXPdPs"
);
const info=document.getElementById("info");
(async()=>{
  const { data:{ user } }=await supabase.auth.getUser();
  if(!user){ location.href="login.html"; return; }
  const { data: p } = await supabase.from("profiles").select("role, company_id").eq("user_id", user.id).single();
  info.textContent = `Du är inloggad som ${user.email}. Roll: ${p?.role||"okänd"}${p?.company_id?` • Företag: ${p.company_id}`:""}.`;
})();
document.getElementById("logoutBtn").onclick=async()=>{ await supabase.auth.signOut(); };
</script>
</body>
</html>
